<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Github Repository Issues</title>
</head>

<body>
  <div class="fullpage">
    <div *ngIf="isLoading">
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>
    <mat-card>
      <mat-card-title>
        <div class="row">
          <img class="col-sm-1 logo" src="../assets/images/softwareag LOGO.png" alt="Softwareag Logo" />
          <div class="col-sm-1 title">
            <div class="row">Github Repository</div>
            <div class="row" style="margin-top: -10px;">Issues</div>
          </div>
          <div class="col-sm-1 toggles">
            <div class="d-flex justify-content-center toggleButtons">
              <mat-button-toggle-group #group="matButtonToggleGroup" [value]="toggleVal"
                (change)="onToggleChange(group.value)">
                <mat-button-toggle matTooltip="Search by Repository Name(s)" value="Repo"><img class="repoLogo"
                    src="../assets/images/repo-icon.png" alt="Repo Name" /></mat-button-toggle>
                <mat-button-toggle matTooltip="Search by Topic Name" value="Topic"><img class="repoLogo"
                    src="../assets/images/hashtagTopic.png" alt="Topic Name" /></mat-button-toggle>
              </mat-button-toggle-group>
            </div>
          </div>
          <div class="col-sm-5 form-container dlt-form-item dlt-search dlt-search--async dlt-search--open"
            *ngIf="toggleVal == 'Repo'">
            <div class="dlt-form-group">
              <form role="search" style="width: 100%;" (submit)="getRepos(repos.value)">
                <label for="header-search" class="visually-hidden">
                  <span>Repos</span>
                </label>
                <input type="text" id="header-search" #repos required class="dlt-text-input dlt-text-search"
                  placeholder="Repo1,Repo2,.." />
                <button class="dlt-button dlt-button-primary" type="submit">
                  <i class="dlt-icon-search dlt-icon-lg"></i>
                </button>
              </form>
            </div>
          </div>
          <div class="col-sm-5 form-container dlt-form-item dlt-search dlt-search--async dlt-search--open"
            *ngIf="toggleVal == 'Topic'">
            <div class="dlt-form-group">
              <form role="search" style="width: 100%;" (submit)="getTopicIssues(Topic.value)">
                <label for="header-search" class="visually-hidden">
                  <span>Topic</span>
                </label>
                <input type="text" id="header-search" #Topic required class="dlt-text-input dlt-text-search"
                  placeholder="Topic Name" />
                <button class="dlt-button dlt-button-primary" type="submit">
                  <i class="dlt-icon-search dlt-icon-lg"></i>
                </button>
              </form>
            </div>
          </div>
          <div class="col-sm-4 d-flex justify-content-center form-container" *ngIf="submitClicked">
            <div class="col-sm-10 d-flex justify-content-center">
              <div class="dlt-form-item dlt-search dlt-search--async dlt-search--open" style="width: 300px;">
                <div class="dlt-form-group dlt-tooltip dlt-tooltip-top-start" aria-description="Informative text about the button">
                  <input type="text" id="header-search" class="dlt-text-input dlt-text-search"
                    (keyup)="applyFilter($event)" placeholder="Filter" />
                  <button class="dlt-button dlt-button-primary" disabled="true">
                    <i class="dlt-icon-filter dlt-icon-lg"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-card-title>
    </mat-card>
    <div class="d-flex justify-content-start searchBy">
    </div>
    <div class="table" *ngIf="submitClicked">
      <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">

        <ng-container matColumnDef="serial">
          <th mat-header-cell *matHeaderCellDef>S.No</th>
          <td mat-cell *matCellDef="let element">{{ element.SNo }}</td>
        </ng-container>

        <ng-container matColumnDef="repository">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>REPOSITORY</th>
          <td mat-cell *matCellDef="let element">{{ element.repository }}</td>
        </ng-container>

        <ng-container matColumnDef="issue_number">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>ISSUE NUM</th>
          <td mat-cell *matCellDef="let element">
            <a href="{{ element.issue_url }}" target="_blank" matTooltip="Visit Issue">{{element.number}}</a>
          </td>
        </ng-container>

        <ng-container matColumnDef="title" class="col-sm-2">
          <th mat-header-cell *matHeaderCellDef>TITLE</th>
          <td mat-cell (click)="titleDialog(element.title)" *matCellDef="let element">
            <div class="ellipsed">{{ element.title }}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="body">
          <th mat-header-cell *matHeaderCellDef>BODY</th>
          <td mat-cell (click)="bodyDialog(element.body)" *matCellDef="let element">
            <div class="ellipsed">{{ element.body }}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="user_name">
          <th mat-header-cell *matHeaderCellDef>USER NAME</th>
          <td mat-cell *matCellDef="let element">{{ element.user.login }}</td>
        </ng-container>

        <ng-container matColumnDef="user_type">
          <th mat-header-cell *matHeaderCellDef>USER TYPE</th>
          <td mat-cell *matCellDef="let element">{{ element.user.type }}</td>
        </ng-container>

        <ng-container matColumnDef="lable_name">
          <th mat-header-cell *matHeaderCellDef>LABLE NAME</th>
          <td mat-cell *matCellDef="let element">
            <span *ngFor="let lable of element.lables">{{ lable.name }}
            </span>
          </td>
        </ng-container>

        <ng-container matColumnDef="created_at">
          <th mat-header-cell *matHeaderCellDef>CREATED AT</th>
          <td mat-cell *matCellDef="let element">{{ element.created_at }}</td>
        </ng-container>

        <ng-container matColumnDef="updated_at">
          <th mat-header-cell *matHeaderCellDef>UPDATED AT</th>
          <td mat-cell *matCellDef="let element">{{ element.updated_at }}</td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
      <!--div *ngIf="isLoading && submitClicked" class="loading">
        <mat-spinner></mat-spinner>
      </div!-->
      <mat-paginator [pageSizeOptions]="[5, 10, 20, 50, 100]" showFirstLastButtons aria-label="Select page of Issues">
      </mat-paginator>
    </div>
  </div>
</body>

</html>